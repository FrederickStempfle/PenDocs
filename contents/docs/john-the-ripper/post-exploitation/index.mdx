---
title: Post-Exploitation - Password Cracking Strategies
description: Learn effective password cracking techniques and strategies using John the Ripper
---

import { Accordion, AccordionItem, AccordionContent, AccordionTrigger } from "@/components/ui/accordion"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Steps, Step } from "@/components/markdown/steps"
import { Note } from "@/components/markdown/note"
import { Callout } from "@/components/markdown/callout"

# Post-Exploitation: Password Cracking Strategies

After successfully extracting password hashes from target systems, the next phase is to crack these hashes to recover plaintext passwords. This guide covers various password cracking strategies using John the Ripper, from basic approaches to advanced techniques.

<Callout type="warning">
  Always ensure you have proper authorization before attempting to crack passwords. Unauthorized password cracking is illegal and unethical.
</Callout>

## Understanding Password Cracking Modes

<Tabs defaultValue="wordlist" className="pt-5 pb-1">
  <TabsList>
    <TabsTrigger value="wordlist">Wordlist Mode</TabsTrigger>
    <TabsTrigger value="rules">Rules Mode</TabsTrigger>
    <TabsTrigger value="incremental">Incremental Mode</TabsTrigger>
    <TabsTrigger value="mask">Mask Mode</TabsTrigger>
  </TabsList>
  <TabsContent value="wordlist">
    ### Wordlist Attack Mode
    
    Wordlist attacks try each word from a dictionary against the password hash.
    
    ```bash
    # Basic wordlist attack
    john --wordlist=/path/to/wordlist.txt hashes.txt
    
    # Specify hash format
    john --format=nt --wordlist=/path/to/wordlist.txt hashes.txt
    
    # Use multiple wordlists
    john --wordlist=/path/to/wordlist1.txt --wordlist=/path/to/wordlist2.txt hashes.txt
    ```
    
    #### Common Wordlists:
    
    - **rockyou.txt**: Large general-purpose wordlist (14 million passwords)
    - **SecLists**: Collection of multiple wordlists for different scenarios
    - **CrackStation**: Very large wordlist of common passwords
    - **Custom wordlists**: Created from target-specific information
  </TabsContent>
  <TabsContent value="rules">
    ### Rules-Based Attack Mode
    
    Rules transform words from a wordlist to create additional password candidates.
    
    ```bash
    # Using built-in rules
    john --wordlist=/path/to/wordlist.txt --rules=Single hashes.txt
    john --wordlist=/path/to/wordlist.txt --rules=Jumbo hashes.txt
    
    # Using custom rules file
    john --wordlist=/path/to/wordlist.txt --rules=/path/to/rules.conf hashes.txt
    ```
    
    #### Common Rule Transformations:
    
    - Capitalization (`password` → `Password`)
    - Toggle case (`password` → `pAsSwOrD`)
    - Leetspeak (`password` → `p4ssw0rd`)
    - Append/prepend characters (`password` → `password123`, `1password`)
    - Character substitution (`password` → `p@ssword`)
  </TabsContent>
  <TabsContent value="incremental">
    ### Incremental (Brute Force) Mode
    
    Incremental mode tries all possible character combinations.
    
    ```bash
    # Basic incremental mode
    john --incremental hashes.txt
    
    # Specific character set
    john --incremental=Digits hashes.txt
    john --incremental=Alpha hashes.txt
    
    # Custom incremental mode
    john --incremental=Custom --external=filter_custom hashes.txt
    ```
    
    #### Incremental Mode Options:
    
    - **All**: All ASCII characters
    - **Alpha**: Alphabetic characters only
    - **Digits**: Numbers only
    - **Alnum**: Alphanumeric characters
    - **LanMan**: Special mode for LM hashes
  </TabsContent>
  <TabsContent value="mask">
    ### Mask Attack Mode
    
    Mask attacks define patterns for password generation.
    
    ```bash
    # Basic mask attack
    john --mask='?d?d?d?d?d?d' hashes.txt  # 6-digit number
    
    # Mixed character mask
    john --mask='?u?l?l?l?l?d?d?d' hashes.txt  # Ullllddd pattern
    
    # Custom character sets
    john --mask='?a?a?a?a?a?a?a?a' hashes.txt  # 8 chars, any ASCII
    ```
    
    #### Mask Notation:
    
    - **?d**: Digit (0-9)
    - **?l**: Lowercase letter (a-z)
    - **?u**: Uppercase letter (A-Z)
    - **?s**: Special character
    - **?a**: All ASCII characters
    - **?b**: All 8-bit characters
  </TabsContent>
</Tabs>

## Cracking Different Hash Types

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
  <Card>
    <CardHeader>
      <CardTitle>Windows Password Hashes</CardTitle>
    </CardHeader>
    <CardContent>
      Strategies for cracking Windows password hashes:
      
      ```bash
      # Cracking NTLM hashes
      john --format=nt --wordlist=/path/to/wordlist.txt windows_hashes.txt
      
      # Cracking LM hashes
      john --format=lm --wordlist=/path/to/wordlist.txt windows_hashes.txt
      
      # Cracking cached domain credentials
      john --format=mscash2 --wordlist=/path/to/wordlist.txt cached_hashes.txt
      ```
      
      **Optimization Tips:**
      
      - NTLM hashes crack very quickly with GPU acceleration
      - LM hashes are even faster to crack due to splitting into two 7-character segments
      - For domain cached credentials, focus on high-value accounts first
    </CardContent>
  </Card>
  
  <Card>
    <CardHeader>
      <CardTitle>Linux/Unix Password Hashes</CardTitle>
    </CardHeader>
    <CardContent>
      Strategies for cracking Linux/Unix password hashes:
      
      ```bash
      # Cracking MD5crypt hashes
      john --format=md5crypt --wordlist=/path/to/wordlist.txt linux_hashes.txt
      
      # Cracking SHA-512crypt hashes
      john --format=sha512crypt --wordlist=/path/to/wordlist.txt linux_hashes.txt
      
      # Cracking bcrypt hashes
      john --format=bcrypt --wordlist=/path/to/wordlist.txt linux_hashes.txt
      ```
      
      **Optimization Tips:**
      
      - Modern Linux hashes (SHA-512crypt, bcrypt) are designed to be slow
      - Focus on targeted wordlists with rules for these hash types
      - Consider distributed cracking for bcrypt hashes
    </CardContent>
  </Card>
</div>

### Database Password Hashes

<Accordion type="single" collapsible>
  <AccordionItem value="mysql">
    <AccordionTrigger>MySQL/MariaDB Hashes</AccordionTrigger>
    <AccordionContent>
      ### Cracking MySQL/MariaDB Hashes
      
      MySQL uses different hash formats depending on version:
      
      ```bash
      # MySQL pre-4.1 (old format)
      john --format=mysql --wordlist=/path/to/wordlist.txt mysql_old_hashes.txt
      
      # MySQL 4.1+ (mysql-sha1)
      john --format=mysql-sha1 --wordlist=/path/to/wordlist.txt mysql_hashes.txt
      
      # MySQL 8.0+ (caching-sha2)
      john --format=mysql-sha256 --wordlist=/path/to/wordlist.txt mysql_new_hashes.txt
      ```
      
      **Strategy Tips:**
      
      - Older MySQL hashes are relatively fast to crack
      - For MySQL 8.0+, focus on targeted wordlists with common database passwords
      - Database passwords often follow patterns like `Company123!` or `DbName2023`
    </AccordionContent>
  </AccordionItem>
  
  <AccordionItem value="mssql">
    <AccordionTrigger>Microsoft SQL Server Hashes</AccordionTrigger>
    <AccordionContent>
      ### Cracking Microsoft SQL Server Hashes
      
      SQL Server uses different hash formats depending on version:
      
      ```bash
      # SQL Server 2000
      john --format=mssql --wordlist=/path/to/wordlist.txt mssql_old_hashes.txt
      
      # SQL Server 2005+
      john --format=mssql05 --wordlist=/path/to/wordlist.txt mssql_hashes.txt
      
      # SQL Server 2012+
      john --format=mssql12 --wordlist=/path/to/wordlist.txt mssql_new_hashes.txt
      ```
      
      **Strategy Tips:**
      
      - SQL Server 2000 hashes are very weak and crack quickly
      - For newer versions, try service account naming patterns
      - Common patterns include `SqlServer2019!`, `Sql$Admin123`, etc.
    </AccordionContent>
  </AccordionItem>
  
  <AccordionItem value="oracle">
    <AccordionTrigger>Oracle Database Hashes</AccordionTrigger>
    <AccordionContent>
      ### Cracking Oracle Database Hashes
      
      Oracle uses different hash formats depending on version:
      
      ```bash
      # Oracle 10g and earlier
      john --format=oracle --wordlist=/path/to/wordlist.txt oracle_old_hashes.txt
      
      # Oracle 11g
      john --format=oracle11 --wordlist=/path/to/wordlist.txt oracle_11g_hashes.txt
      
      # Oracle 12c+
      john --format=oracle12c --wordlist=/path/to/wordlist.txt oracle_12c_hashes.txt
      ```
      
      **Strategy Tips:**
      
      - Oracle passwords are often complex due to default policies
      - Try variations of the database name, SID, or company name
      - Oracle DBAs often use patterns like `Oracle_123`, `SID_admin_2023`, etc.
    </AccordionContent>
  </AccordionItem>
  
  <AccordionItem value="postgres">
    <AccordionTrigger>PostgreSQL Hashes</AccordionTrigger>
    <AccordionContent>
      ### Cracking PostgreSQL Hashes
      
      PostgreSQL uses MD5 with the username as salt:
      
      ```bash
      # PostgreSQL MD5
      john --format=postgres --wordlist=/path/to/wordlist.txt postgres_hashes.txt
      
      # PostgreSQL SCRAM-SHA-256 (10+)
      # Currently limited support in John, may require preprocessing
      ```
      
      **Strategy Tips:**
      
      - PostgreSQL passwords often include the database name or 'postgres'
      - Try variations like `postgres123`, `Pg@dmin2023`, etc.
      - For SCRAM-SHA-256, focus on shorter passwords and common patterns
    </AccordionContent>
  </AccordionItem>
</Accordion>

## Advanced Cracking Strategies

<Steps>
  <Step title="Targeted Wordlist Creation">
    Create custom wordlists based on the target:
    
    ```bash
    # Combine existing wordlists
    cat wordlist1.txt wordlist2.txt | sort -u > combined_wordlist.txt
    
    # Extract words from target website
    cewl -d 2 -m 6 https://target-company.com -w target_words.txt
    
    # Generate variations of company information
    echo "CompanyName" | john --wordlist=- --stdout --rules=AppendYears > company_variations.txt
    ```
    
    Targeted wordlists significantly increase success rates.
  </Step>
  
  <Step title="Custom Rule Development">
    Create custom rules based on password patterns:
    
    ```bash
    # Create a custom rules file
    echo "[List.Rules:Custom]" > custom.rules
    echo "c" >> custom.rules  # Capitalize
    echo "$1" >> custom.rules  # Append 1
    echo "$!" >> custom.rules  # Append !
    
    # Use the custom rules
    john --wordlist=/path/to/wordlist.txt --rules=custom.rules hashes.txt
    ```
    
    Analyze previously cracked passwords to identify patterns for custom rules.
  </Step>
  
  <Step title="Hybrid Attacks">
    Combine multiple attack methods:
    
    ```bash
    # Wordlist + Rules + Incremental
    john --wordlist=/path/to/wordlist.txt --rules=Jumbo --incremental=Alnum hashes.txt
    
    # Mask attack with custom character sets
    john --mask='Company?d?d?d?s' hashes.txt
    
    # Prince attack (available in jumbo version)
    john --prince=/path/to/wordlist.txt --prince-loopback hashes.txt
    ```
    
    Hybrid attacks are effective for complex password policies.
  </Step>
  
  <Step title="Session Management">
    Manage cracking sessions efficiently:
    
    ```bash
    # Start a named session
    john --session=session_name --wordlist=/path/to/wordlist.txt hashes.txt
    
    # Resume a session
    john --restore=session_name
    
    # Show cracked passwords
    john --show hashes.txt
    
    # Show cracking status
    john --status=session_name
    ```
    
    Proper session management allows for efficient resource utilization.
  </Step>
</Steps>

## Optimizing Cracking Performance

<Tabs defaultValue="hardware" className="pt-5 pb-1">
  <TabsList>
    <TabsTrigger value="hardware">Hardware Optimization</TabsTrigger>
    <TabsTrigger value="software">Software Optimization</TabsTrigger>
    <TabsTrigger value="distributed">Distributed Cracking</TabsTrigger>
  </TabsList>
  <TabsContent value="hardware">
    ### Hardware Optimization Strategies
    
    Optimize hardware for better cracking performance:
    
    ```bash
    # Use OpenCL for GPU acceleration
    john --format=nt-opencl --wordlist=/path/to/wordlist.txt hashes.txt
    
    # Specify OpenCL device
    john --format=nt-opencl --wordlist=/path/to/wordlist.txt --device=0 hashes.txt
    
    # Benchmark to find optimal settings
    john --test=10 --format=nt-opencl
    ```
    
    **Hardware Considerations:**
    
    - GPUs significantly outperform CPUs for most hash types
    - NVIDIA GPUs generally perform better than AMD for John the Ripper
    - Memory-hard hashes (bcrypt, Argon2) benefit less from GPU acceleration
    - Consider cooling and power supply for extended cracking sessions
  </TabsContent>
  <TabsContent value="software">
    ### Software Optimization Strategies
    
    Optimize software settings for better performance:
    
    ```bash
    # Set OpenMP thread count
    export OMP_NUM_THREADS=4
    john --format=sha512crypt --wordlist=/path/to/wordlist.txt hashes.txt
    
    # Adjust buffer size for wordlist processing
    john --format=nt --wordlist=/path/to/wordlist.txt --stdout=100000 hashes.txt
    
    # Use optimized formats when available
    john --format=raw-sha256-opencl --wordlist=/path/to/wordlist.txt hashes.txt
    ```
    
    **Software Considerations:**
    
    - Compile John the Ripper with appropriate optimizations
    - Use the latest jumbo version for best performance
    - Balance thread count with available CPU cores
    - For GPU cracking, adjust worksize based on your GPU model
  </TabsContent>
  <TabsContent value="distributed">
    ### Distributed Cracking Strategies
    
    Distribute cracking across multiple systems:
    
    ```bash
    # Split workload by node
    # On system 1:
    john --format=nt --wordlist=/path/to/wordlist.txt --node=1/3 hashes.txt
    
    # On system 2:
    john --format=nt --wordlist=/path/to/wordlist.txt --node=2/3 hashes.txt
    
    # On system 3:
    john --format=nt --wordlist=/path/to/wordlist.txt --node=3/3 hashes.txt
    ```
    
    **Distributed Considerations:**
    
    - Ensure all nodes have the same version of John the Ripper
    - Split workload based on system capabilities
    - Consider network-based solutions like Hashtopolis for larger deployments
    - Maintain a central repository for cracked passwords
  </TabsContent>
</Tabs>

## Password Analysis and Reporting

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
  <Card>
    <CardHeader>
      <CardTitle>Password Strength Analysis</CardTitle>
    </CardHeader>
    <CardContent>
      Analyze cracked passwords to identify patterns:
      
      ```bash
      # Show all cracked passwords
      john --show hashes.txt
      
      # Show statistics
      john --show=stats hashes.txt
      
      # Export cracked passwords
      john --show hashes.txt > cracked_passwords.txt
      ```
      
      Use tools like `statsprocessor` or custom scripts to analyze:
      
      - Password length distribution
      - Character set usage
      - Common patterns and structures
      - Compliance with password policy
      
      This analysis helps improve password policies.
    </CardContent>
  </Card>
  
  <Card>
    <CardHeader>
      <CardTitle>Reporting Findings</CardTitle>
    </CardHeader>
    <CardContent>
      Create comprehensive reports on password security:
      
      ```bash
      # Generate basic statistics
      grep -o '.\{1\}' cracked_passwords.txt | sort | uniq -c | sort -nr
      
      # Count password lengths
      awk '{print length}' cracked_passwords.txt | sort -n | uniq -c
      
      # Find common patterns
      grep -E '[a-z]+[0-9]{2,4}' cracked_passwords.txt | wc -l
      ```
      
      Include in your report:
      
      - Percentage of cracked passwords
      - Time required to crack different password types
      - Common patterns identified
      - Recommendations for policy improvements
      - Examples of weak vs. strong passwords (sanitized)
    </CardContent>
  </Card>
</div>

### Password Policy Recommendations

<Steps>
  <Step title="Analyze current policy effectiveness">
    Evaluate the current password policy based on cracking results:
    
    ```bash
    # Check for short passwords
    awk 'length($0) < 10' cracked_passwords.txt | wc -l
    
    # Check for passwords without special characters
    grep -v '[^a-zA-Z0-9]' cracked_passwords.txt | wc -l
    
    # Check for common patterns
    grep -E '[A-Z][a-z]+[0-9]{1,4}[!@#$%^&*]?' cracked_passwords.txt | wc -l
    ```
    
    Quantify the weaknesses in the current policy.
  </Step>
  
  <Step title="Develop policy recommendations">
    Based on analysis, recommend policy improvements:
    
    - Increase minimum password length (12+ characters)
    - Require multiple character types
    - Implement password blacklists for common passwords
    - Consider passphrases instead of complex passwords
    - Implement multi-factor authentication
    
    Support recommendations with data from your cracking results.
  </Step>
  
  <Step title="Demonstrate policy effectiveness">
    Show the effectiveness of recommended policies:
    
    ```bash
    # Attempt to crack passwords meeting new policy
    john --wordlist=/path/to/wordlist.txt --rules=All strong_password_hashes.txt
    
    # Compare cracking success rates
    john --show weak_password_hashes.txt | wc -l
    john --show strong_password_hashes.txt | wc -l
    ```
    
    Provide metrics on improved resistance to cracking.
  </Step>
</Steps>

## Case Studies and Scenarios

<Accordion type="single" collapsible>
  <AccordionItem value="corporate">
    <AccordionTrigger>Corporate Network Assessment</AccordionTrigger>
    <AccordionContent>
      ### Corporate Network Password Audit
      
      **Scenario:** A financial services company wants to assess the strength of employee passwords.
      
      **Approach:**
      
      1. Extract password hashes from Active Directory using authorized methods
      2. Prepare hashes for cracking with John the Ripper
      
      ```bash
      # Process NTDS.dit dump
      secretsdump.py -ntds ntds.dit -system registry/SYSTEM LOCAL > ad_dump.txt
      grep -E ":::[^:]+:::" ad_dump.txt | cut -d: -f1,4 > ntlm_hashes.txt
      ```
      
      3. Start with targeted wordlists based on company information
      
      ```bash
      # Create company-specific wordlist
      cewl -d 2 -m 6 https://company.com -w company_words.txt
      john --wordlist=company_words.txt --rules=AppendYear ntlm_hashes.txt
      ```
      
      4. Use common password lists with rules
      
      ```bash
      john --wordlist=/usr/share/wordlists/rockyou.txt --rules=Jumbo ntlm_hashes.txt
      ```
      
      5. Analyze results and provide recommendations
      
      **Results:**
      - 35% of passwords cracked within 24 hours
      - Common patterns included company name + year
      - Several high-privilege accounts had weak passwords
      
      **Recommendations:**
      - Implement 16-character minimum for privileged accounts
      - Deploy password blacklisting solution
      - Implement regular password audits
    </AccordionContent>
  </AccordionItem>
  
  <AccordionItem value="web">
    <AccordionTrigger>Web Application Assessment</AccordionTrigger>
    <AccordionContent>
      ### Web Application Password Audit
      
      **Scenario:** An e-commerce platform wants to test the strength of customer passwords.
      
      **Approach:**
      
      1. Extract password hashes from the database (with authorization)
      
      ```bash
      # Export hashes from database
      mysqldump -u admin -p --no-create-info --where="1 limit 10000" ecommerce users > users_dump.sql
      grep -Eo "'[a-f0-9]{32}'" users_dump.sql | tr -d "'" > md5_hashes.txt
      ```
      
      2. Identify hash format and prepare for cracking
      
      ```bash
      # Determine hash type
      hashid -m md5_hashes.txt
      
      # Format for John
      awk '{print "user:"$1}' md5_hashes.txt > john_hashes.txt
      ```
      
      3. Start with fast cracking methods
      
      ```bash
      # Try common passwords first
      john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt john_hashes.txt
      ```
      
      4. Use targeted rules based on e-commerce patterns
      
      ```bash
      # Create custom rules for e-commerce patterns
      echo "[List.Rules:Ecommerce]" > ecommerce.rules
      echo "c $1 $2 $3 $!" >> ecommerce.rules
      john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt --rules=Ecommerce john_hashes.txt
      ```
      
      **Results:**
      - 62% of passwords cracked within 48 hours
      - Many passwords were simple variations of product names
      - Password complexity requirements were easily circumvented
      
      **Recommendations:**
      - Implement modern password hashing (bcrypt/Argon2)
      - Add client and server-side password strength meters
      - Consider passwordless authentication options
    </AccordionContent>
  </AccordionItem>
</Accordion>

## Ethical Considerations and Best Practices

<Callout type="warning">
  Password cracking, even when authorized, involves handling sensitive data. Always follow ethical guidelines and legal requirements.
</Callout>

### Responsible Password Cracking

<Steps>
  <Step title="Maintain proper authorization">
    Always ensure you have:
    
    - Written permission from the system owner
    - Clear scope definition
    - Proper documentation of activities
    - Compliance with relevant regulations (GDPR, HIPAA, etc.)
  </Step>
  
  <Step title="Secure handling of password data">
    Protect all password data:
    
    - Store hash files in encrypted containers
    - Limit access to authorized personnel
    - Securely delete files when no longer needed
    - Never share cracked passwords unnecessarily
  </Step>
  
  <Step title="Responsible reporting">
    Report findings responsibly:
    
    - Focus on patterns and statistics, not individual passwords
    - Provide actionable recommendations
    - Avoid naming specific users with weak passwords
    - Emphasize education over punishment
  </Step>
</Steps>

<Note title="Professional Tip">
  When presenting password cracking results to clients or management, focus on metrics and patterns rather than specific passwords. For example, report "15% of executive accounts had passwords based on company names" rather than listing actual passwords. This maintains professionalism while still conveying the security issues.
</Note>

## Next Steps

Now that you understand password cracking strategies with John the Ripper, you can:

1. Learn about [optimization best practices](/docs/john-the-ripper/optimization-best-practices) to improve cracking efficiency
2. Explore [tool integration](/docs/john-the-ripper/tool-integration) to combine John with other security tools
3. Study [reporting and remediation](/docs/john-the-ripper/reporting-remediation) to effectively communicate findings
